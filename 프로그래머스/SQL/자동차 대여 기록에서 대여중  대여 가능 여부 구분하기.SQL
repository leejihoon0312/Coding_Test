-- 코드를 입력하세요

SELECT A.CAR_ID,
(
    CASE
        WHEN B.CAR_ID IS NOT NULL THEN "대여중"
        ELSE "대여 가능"
    END
) AS AVAILABILITY

FROM


(SELECT CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID) AS A

LEFT JOIN


(SELECT CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE "2022-10-16" BETWEEN DATE_FORMAT(START_DATE,"%Y-%m-%d") AND DATE_FORMAT(END_DATE,"%Y-%m-%d")
GROUP BY CAR_ID) AS B

ON A.CAR_ID = B.CAR_ID

ORDER BY CAR_ID DESC
