SELECT A.author_id, AUTHOR_NAME, category, TOTAL_SALES

FROM

(SELECT author_id,category,SUM(TOTAL_SALES) AS TOTAL_SALES

FROM

(SELECT SALES.book_id ,CATEGORY,	AUTHOR_ID,	PRICE, SALES_AMOUNT,   PRICE*SALES_AMOUNT AS TOTAL_SALES

FROM

(SELECT book_id, SUM(SALES) AS SALES_AMOUNT
FROM BOOK_SALES
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 1
GROUP BY BOOK_ID) AS SALES

JOIN

(SELECT *
FROM BOOK  ) AS B

ON SALES.book_id = B.book_id) AS TOTAL

GROUP BY author_id, category) AS LAST

JOIN

(SELECT *
FROM AUTHOR   ) AS A

ON A.author_id = LAST.author_id

ORDER BY author_id,category DESC